{
  "session_id": "294df8f245604586",
  "admin_id": 1,
  "step_name": "sql_validate",
  "status": "success",
  "error_message": null,
  "timestamp": "2026-02-12T18:11:10",
  "input": {
    "sql_result": {
      "sql": "WITH latest_term AS (SELECT MAX(term) as max_term FROM score WHERE score.is_deleted = 0), base AS (SELECT class.grade_year, AVG(score.score_value) as avg_score FROM score JOIN student ON score.student_id = student.id JOIN class ON student.class_id = class.id CROSS JOIN latest_term WHERE score.is_deleted = 0 AND student.is_deleted = 0 AND class.is_deleted = 0 AND score.term = latest_term.max_term GROUP BY class.grade_year) SELECT base.grade_year, base.avg_score FROM base ORDER BY base.grade_year",
      "entity_mappings": [],
      "sql_fields": [
        "score.is_deleted",
        "class.grade_year",
        "score.score_value",
        "score.student_id",
        "student.id",
        "student.class_id",
        "class.id",
        "student.is_deleted",
        "class.is_deleted",
        "score.term",
        "latest_term.max_term",
        "base.grade_year",
        "base.avg_score"
      ],
      "applied_field_replacements": []
    }
  },
  "output": {
    "is_valid": true,
    "error": null,
    "rows": 4,
    "result": [
      {
        "grade_year": 2022,
        "avg_score": 74.89887740707144
      },
      {
        "grade_year": 2023,
        "avg_score": 74.94132191765485
      },
      {
        "grade_year": 2024,
        "avg_score": 75.08570407893679
      },
      {
        "grade_year": 2025,
        "avg_score": 74.92667376342078
      }
    ],
    "executed_sql": "WITH latest_term AS (SELECT MAX(term) as max_term FROM score WHERE score.is_deleted = 0), base AS (SELECT class.grade_year, AVG(score.score_value) as avg_score FROM score JOIN student ON score.student_id = student.id JOIN class ON student.class_id = class.id CROSS JOIN latest_term WHERE score.is_deleted = 0 AND student.is_deleted = 0 AND class.is_deleted = 0 AND score.term = latest_term.max_term GROUP BY class.grade_year) SELECT base.grade_year, base.avg_score FROM base ORDER BY base.grade_year",
    "empty_result": false,
    "zero_metric_result": false
  }
}