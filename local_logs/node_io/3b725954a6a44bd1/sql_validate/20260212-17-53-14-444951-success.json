{
  "session_id": "3b725954a6a44bd1",
  "admin_id": 1,
  "step_name": "sql_validate",
  "status": "success",
  "error_message": null,
  "timestamp": "2026-02-12T17:53:14",
  "input": {
    "sql_result": {
      "sql": "WITH latest_term AS (SELECT MAX(score.term) AS term FROM score WHERE score.is_deleted = 0), base AS (SELECT class.grade_year, score.score_value FROM score JOIN enroll ON score.student_id = enroll.id JOIN student ON enroll.student_id = student.id JOIN class ON student.class_id = class.id JOIN latest_term ON score.term = latest_term.term WHERE score.is_deleted = 0 AND enroll.is_deleted = 0 AND student.is_deleted = 0 AND class.is_deleted = 0) SELECT base.grade_year, AVG(base.score_value) AS avg_score_value FROM base GROUP BY base.grade_year ORDER BY base.grade_year",
      "entity_mappings": [],
      "sql_fields": [
        "score.term",
        "score.is_deleted",
        "class.grade_year",
        "score.score_value",
        "score.student_id",
        "enroll.id",
        "enroll.student_id",
        "student.id",
        "student.class_id",
        "class.id",
        "latest_term.term",
        "enroll.is_deleted",
        "student.is_deleted",
        "class.is_deleted",
        "base.grade_year",
        "base.score_value"
      ],
      "applied_field_replacements": [
        {
          "from": "score.enroll_id",
          "to": "score.student_id"
        }
      ]
    }
  },
  "output": {
    "is_valid": true,
    "error": null,
    "rows": 4,
    "result": [
      {
        "grade_year": 2022,
        "avg_score_value": 75.03901401704309
      },
      {
        "grade_year": 2023,
        "avg_score_value": 74.8875910093842
      },
      {
        "grade_year": 2024,
        "avg_score_value": 74.94234368843212
      },
      {
        "grade_year": 2025,
        "avg_score_value": 74.97217392342013
      }
    ],
    "executed_sql": "WITH latest_term AS (SELECT MAX(score.term) AS term FROM score WHERE score.is_deleted = 0), base AS (SELECT class.grade_year, score.score_value FROM score JOIN enroll ON score.student_id = enroll.id JOIN student ON enroll.student_id = student.id JOIN class ON student.class_id = class.id JOIN latest_term ON score.term = latest_term.term WHERE score.is_deleted = 0 AND enroll.is_deleted = 0 AND student.is_deleted = 0 AND class.is_deleted = 0) SELECT base.grade_year, AVG(base.score_value) AS avg_score_value FROM base GROUP BY base.grade_year ORDER BY base.grade_year",
    "empty_result": false,
    "zero_metric_result": false
  }
}